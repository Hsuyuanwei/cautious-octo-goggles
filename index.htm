<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŒœæ•°å­—æ¸¸æˆ (1A2B)</title>
    <style>
        #guess-log {
            margin-top: 15px;
            padding: 10px;
            border: 1px solid #ccc;
            height: 200px;
            overflow-y: auto;
            background-color: #f9f9f9;
        }
        .correct {
            color: green;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>ğŸ”¢ çŒœæ•°å­—æ¸¸æˆ (1A2B)</h1>
    <p id="message">è¯·ç‚¹å‡»â€œå¼€å§‹æ–°æ¸¸æˆâ€æŒ‰é’®ã€‚</p>
    
    <input type="number" id="input" placeholder="è¾“å…¥æ‚¨çš„å››ä½æ•°å­—çŒœæ¸¬ (ä¾‹: 1234)" maxlength="4">
    <button onclick="checkGuess()">çŒœæ¸¬</button> 
    <button onclick="startGame()">å¼€å§‹æ–°æ¸¸æˆ</button> 

    <h3>çŒœæ¸¬è®°å½•:</h3>
    <div id="guess-log"></div>
    
    <script>
        // å…¨å±€å˜é‡
        let secretNumber = '';
        let guessCount = 0;

        // ã€ç›®æ ‡æ•°å­—ç”Ÿæˆå‡½æ•°ã€‘ ç”Ÿæˆä¸€ä¸ªå››ä½ä¸”æ•°å­—ä¸é‡å¤çš„ç§˜å¯†æ•°å­—
        // ç»å…¸ 1A2B ç©æ³•è¦æ±‚ç›®æ ‡æ•°å­—ä¸é‡å¤
        function generateUniqueNumber() {
            let digits = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];
            let numberArray = [];

            // 1. æ´—ç‰Œï¼šæ‰“ä¹±æ•°ç»„é¡ºåº
            for (let i = digits.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [digits[i], digits[j]] = [digits[j], digits[i]];
            }

            // 2. å–å‰å››ä½ä½œä¸ºç§˜å¯†æ•°å­—
            numberArray = digits.slice(0, 4);

            // 3. ç¡®ä¿ç¬¬ä¸€ä½ä¸æ˜¯ '0'ï¼Œå¦åˆ™æ•°å­—ä¸è¶³å››ä½
            if (numberArray[0] === '0') {
                 [numberArray[0], numberArray[3]] = [numberArray[3], numberArray[0]];
            }

            secretNumber = numberArray.join('');
            console.log("ç§˜å¯†æ•°å­—å·²ç”Ÿæˆ");
        }

        // åˆå§‹åŒ–æˆ–é‡æ–°å¼€å§‹æ¸¸æˆ
        function startGame() {
            generateUniqueNumber();
            guessCount = 0;
            document.getElementById('message').textContent = 'ä¸€ä¸ªæ–°çš„å››ä½ç§˜å¯†æ•°å­—å·²ç”Ÿæˆï¼Œè¯·å¼€å§‹çŒœæ¸¬ï¼';
            document.getElementById('guess-log').innerHTML = ''; // æ¸…ç©ºå†å²è®°å½•
            document.getElementById('input').value = ''; // æ¸…ç©ºè¾“å…¥æ¡†
            document.getElementById('input').disabled = false; // å¯ç”¨è¾“å…¥
        }

        // æ£€æŸ¥çŒœæ¸¬çš„æ ¸å¿ƒé€»è¾‘
        function checkGuess() {
            const inputElement = document.getElementById('input');
            const guess = inputElement.value;
            const logElement = document.getElementById('guess-log');
            const messageElement = document.getElementById('message');

            // --- éªŒè¯æ£€æŸ¥ ---
            if (guess.length !== 4 || isNaN(guess)) {
                alert("è¯·è¾“å…¥ä¸€ä¸ªæœ‰æ•ˆçš„å››ä½æ•°å­—ï¼");
                return;
            }

            if (!secretNumber) {
                alert("è¯·å…ˆç‚¹å‡» 'å¼€å§‹æ–°æ¸¸æˆ' æŒ‰é’®ï¼");
                return;
            }
            
            guessCount++;

            let bulls = 0; // ä½ç½®å’Œæ•°å­—éƒ½æ­£ç¡® ('A')
            let cows = 0;  // æ•°å­—æ­£ç¡®ä½†ä½ç½®é”™è¯¯ ('B')

            // --- è®¡ç®—é€»è¾‘ ---
            // ç»å…¸çš„ 1A2B ç®—æ³•ï¼ŒåŸºäºç§˜å¯†æ•°å­—ä¸é‡å¤ï¼Œä½†å…è®¸çŒœæ¸¬é‡å¤
            for (let i = 0; i < 4; i++) {
                // 1. æ£€æŸ¥ Bulls (A)
                if (guess[i] === secretNumber[i]) {
                    bulls++;
                } else {
                    // 2. æ£€æŸ¥ Cows (B)
                    if (secretNumber.includes(guess[i])) {
                        cows++;
                    }
                }
            }

            // --- æ˜¾ç¤ºç»“æœ ---
            const result = `${bulls}A${cows}B`;
            const logEntry = document.createElement('p');
            logEntry.textContent = `[${guessCount} æ¬¡] æ‚¨çš„çŒœæ¸¬: ${guess} -> ç»“æœ: ${result}`;

            // æ£€æŸ¥èƒœåˆ©æ¡ä»¶
            if (bulls === 4) {
                logEntry.classList.add('correct');
                messageElement.textContent = `ğŸ‰ æ­å–œï¼æ‚¨åœ¨ ${guessCount} æ¬¡çŒœæ¸¬ä¸­çŒœä¸­äº†ç§˜å¯†æ•°å­— (${secretNumber})ï¼`;
                inputElement.disabled = true; // èƒœåˆ©åç¦ç”¨è¾“å…¥
            } else {
                messageElement.textContent = `å†è¯•ä¸€æ¬¡ï¼ç»“æœæ˜¯ ${result}ã€‚`;
            }

            logElement.prepend(logEntry); // å°†æ–°è®°å½•æ·»åŠ åˆ°é¡¶éƒ¨
            inputElement.value = ''; // æ¸…ç©ºè¾“å…¥æ¡†
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨å¯åŠ¨æ¸¸æˆ
        window.onload = startGame;
    </script>
</body>
</html>